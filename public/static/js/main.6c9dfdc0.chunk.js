(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{120:function(e,a,t){e.exports=t(218)},126:function(e,a,t){},127:function(e,a,t){},218:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(10),l=t(7),o=t(14),i=t.n(o),u=(t(125),t(126),t(6)),s=(t(127),t(224)),m=t(223),d=t(225),h=t(226),p=t(109),f=t(227);var g=function(e){var a=e.loggedInUser,t=e.showLogin,n=e.showSignup,l=e.logout;return!1===a?r.a.createElement(m.a,null):null===a?r.a.createElement(s.a,{fluid:!0},r.a.createElement("div",{className:"navbar"},r.a.createElement(d.a,{variant:"pills"},r.a.createElement(h.a,{className:"justify-content-between",style:{width:"100vw"}},r.a.createElement(p.a,{lg:5,style:{display:"flex"}},r.a.createElement(d.a.Item,null,r.a.createElement(d.a.Link,{as:c.c,to:"/"},r.a.createElement("i",{className:"fas fa-home"}))),r.a.createElement(d.a.Item,null,r.a.createElement(d.a.Link,{onClick:t},"Login")),r.a.createElement(d.a.Item,null,r.a.createElement(d.a.Link,{onClick:n},"Signup"))),r.a.createElement(p.a,{lg:2},r.a.createElement(f.a,{title:"Mi perfil",id:"nav-dropdown",drop:"left"},r.a.createElement(f.a.Item,{eventKey:"4.1"},"Action"),r.a.createElement(f.a.Item,{eventKey:"4.2"},"Another action"),r.a.createElement(f.a.Item,{eventKey:"4.3"},"Something else here"),r.a.createElement(f.a.Divider,null),r.a.createElement(f.a.Item,{eventKey:"4.4"},"Separated link"))))))):r.a.createElement(s.a,{fluid:!0},r.a.createElement("div",{className:"navbar"},r.a.createElement(d.a,{variant:"pills"},r.a.createElement(h.a,{className:"justify-content-between",style:{width:"100vw"}},r.a.createElement(p.a,{lg:5,style:{display:"flex"}},r.a.createElement(d.a.Item,null,r.a.createElement(d.a.Link,{as:c.c,to:"/"},r.a.createElement("i",{className:"fas fa-home"}))),r.a.createElement(d.a.Item,null,r.a.createElement(d.a.Link,{as:c.c,to:"/myGames"},"Mis Partidas")),r.a.createElement(d.a.Item,null,r.a.createElement(d.a.Link,{as:c.c,to:"/myCharacters"},"Mis personajes")),r.a.createElement(d.a.Item,null,r.a.createElement(d.a.Link,{as:c.c,to:"/newGame"},"Crear Partida"))),r.a.createElement(p.a,{lg:2},r.a.createElement(f.a,{title:"Mi perfil",id:"nav-dropdown",drop:"left"},r.a.createElement(f.a.Item,{eventKey:"4.1",onClick:l},"LogOut"),r.a.createElement(f.a.Item,{eventKey:"4.2"},"Another action"),r.a.createElement(f.a.Item,{eventKey:"4.3"},"Something else here"),r.a.createElement(f.a.Divider,null),r.a.createElement(f.a.Item,{eventKey:"4.4"},"Separated link")))))))};var E=function(e){var a=e.games,t=e.loggedInUser;return a.map((function(e,a){return r.a.createElement("div",{className:"centered",key:a},r.a.createElement("h3",null,r.a.createElement(c.b,{to:t&&t._id===e.creator?"/modify/".concat(e._id):"/read/".concat(e._id)},e.title)),r.a.createElement("em",null,"Nivel minimo: ",e.minLevel),r.a.createElement("p",null,e.description.slice(0,350)))}))};var v=function(){return r.a.createElement(s.a,null,r.a.createElement(h.a,null,r.a.createElement(p.a,{lg:6},"Imagen"),r.a.createElement(p.a,{lg:6},"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Similique pariatur magni nesciunt soluta expedita molestiae suscipit deleniti consequuntur dolor impedit. Itaque iure libero perspiciatis, cum asperiores eveniet non error totam?")))},b=t(15),C=t(16),j=t(17),O=t.n(j),I=function(){function e(){Object(b.a)(this,e),this.baseURL="".concat("https://tellmaster.herokuapp.com/api","/games/"),this.service=O.a.create({baseURL:this.baseURL,withCredentials:!0})}return Object(C.a)(e,[{key:"getOneGame",value:function(e){return this.service.get("/?gameId=".concat(e)).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}},{key:"getLastGames",value:function(){return this.service.get("/last?limit=5").then((function(e){return e.data.gamesFound})).catch((function(e){return console.log(e)}))}},{key:"createGame",value:function(e){var a=e.creator,t=e.title,n=e.minLevel,r=e.description;return this.service.post("",{creator:a,title:t,minLevel:n,description:r}).then((function(e){return e.data.createdGame})).catch((function(e){return console.log(e)}))}}]),e}(),y=function(){function e(){Object(b.a)(this,e),this.baseURL="".concat("https://tellmaster.herokuapp.com/api","/auth/"),this.service=O.a.create({baseURL:this.baseURL,withCredentials:!0,timeout:3e4,timeoutErrorMessage:"El servidor ha tardado demasiado tiempo en responder"})}return Object(C.a)(e,[{key:"login",value:function(e){var a=e.username,t=e.email,n=e.password;return this.service.post("login",{username:a,email:t,password:n}).then((function(e){return e.data})).catch((function(e){console.log({err:e}),"ECONNABORTED"===e.code&&console.error(e.message)}))}},{key:"signup",value:function(e){var a=e.username,t=e.email,n=e.password;return this.service.post("signup",{username:a,email:t,password:n}).then((function(e){return e.data})).catch((function(e){console.log({err:e}),"ECONNABORTED"===e.code&&console.error(e.message)}))}},{key:"logout",value:function(){return this.service.post("logout").then((function(e){return e.data})).catch((function(e){console.log({err:e}),"ECONNABORTED"===e.code&&console.error(e.message)}))}},{key:"loggedin",value:function(){return this.service.get("loggedin").then((function(e){return e.data})).catch((function(e){console.log({err:e}),"ECONNABORTED"===e.code&&console.error(e.message)}))}}]),e}(),w=t(229),k=t(110);var S=function(e){var a=e.setUser,t=e.onHide,c=new y,l=Object(n.useState)(""),o=Object(u.a)(l,2),i=o[0],s=o[1],m=Object(n.useState)(""),d=Object(u.a)(m,2),h=d[0],p=d[1],f=Object(n.useState)(""),g=Object(u.a)(f,2),E=g[0],v=g[1];function b(e){var a=e.currentTarget,t=a.name,n=a.value;switch(t){case"username":s(n);break;case"email":p(n);break;case"password":v(n);break;default:throw Error("no correct value")}}return r.a.createElement(w.a,{onSubmit:function(e){e.preventDefault(),c.login({username:i,email:h,password:E}).then((function(e){return a(e)})),s(""),p(""),v(""),t&&t()}},r.a.createElement(w.a.Group,{controlId:"username"},r.a.createElement(w.a.Label,null,"Username"),r.a.createElement(w.a.Control,{onChange:b,name:"username",value:i,type:"text",placeholder:"Enter username"}),r.a.createElement(w.a.Text,{className:"text-muted"},"Choose an username.")),r.a.createElement(w.a.Group,{controlId:"email",value:h},r.a.createElement(w.a.Label,null,"Email address"),r.a.createElement(w.a.Control,{onChange:b,name:"email",type:"email",placeholder:"Enter email"}),r.a.createElement(w.a.Text,{className:"text-muted"},"We'll never share your email with anyone else.")),r.a.createElement(w.a.Group,{controlId:"password",value:E},r.a.createElement(w.a.Label,null,"Password"),r.a.createElement(w.a.Control,{onChange:b,name:"password",type:"password",placeholder:"Password"})),r.a.createElement(k.a,{variant:"primary",type:"submit"},"Submit"))};var L=function(e){var a=e.setUser,t=e.onHide,c=new y,l=Object(n.useState)(""),o=Object(u.a)(l,2),i=o[0],s=o[1],m=Object(n.useState)(""),d=Object(u.a)(m,2),h=d[0],p=d[1],f=Object(n.useState)(""),g=Object(u.a)(f,2),E=g[0],v=g[1];function b(e){var a=e.currentTarget,t=a.name,n=a.value;switch(t){case"username":s(n);break;case"email":p(n);break;case"password":v(n);break;default:throw Error("no correct value")}}return r.a.createElement(w.a,{onSubmit:function(e){e.preventDefault(),c.signup({username:i,email:h,password:E}).then((function(e){return a(e)})),t&&t()}},r.a.createElement(w.a.Group,{controlId:"username"},r.a.createElement(w.a.Label,null,"Username"),r.a.createElement(w.a.Control,{onChange:b,name:"username",value:i,type:"text",placeholder:"Enter username"}),r.a.createElement(w.a.Text,{className:"text-muted"},"Choose an username.")),r.a.createElement(w.a.Group,{controlId:"email",value:h},r.a.createElement(w.a.Label,null,"Email address"),r.a.createElement(w.a.Control,{onChange:b,name:"email",type:"email",placeholder:"Enter email"}),r.a.createElement(w.a.Text,{className:"text-muted"},"We'll never share your email with anyone else.")),r.a.createElement(w.a.Group,{controlId:"password",value:E},r.a.createElement(w.a.Label,null,"Password"),r.a.createElement(w.a.Control,{onChange:b,name:"password",type:"password",placeholder:"Password"})),r.a.createElement(k.a,{variant:"primary",type:"submit"},"Submit"))},G=t(228);var x=function(e){var a=e.show,t=e.children,c=e.onHide,l=e.title;return r.a.createElement(G.a,{show:a,onHide:c,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,autoFocus:!0},r.a.createElement(G.a.Header,{closeButton:!0,onHide:c},r.a.createElement(G.a.Title,{id:"contained-modal-title-vcenter"},l)),r.a.createElement(G.a.Body,null,Object(n.cloneElement)(t,{show:a,onHide:c})))};var U=Object(l.f)((function(e){var a=e.loggedInUser,t=e.updateLastGames,c=e.history,l=new I,o=Object(n.useState)(""),i=Object(u.a)(o,2),s=i[0],m=i[1],d=Object(n.useState)(1),h=Object(u.a)(d,2),p=h[0],f=h[1],g=Object(n.useState)(""),E=Object(u.a)(g,2),v=E[0],b=E[1];function C(e){var a=e.currentTarget,t=a.name,n=a.value;switch(t){case"title":m(n);break;case"description":b(n);break;case"minLevel":f(n);break;default:throw Error("Algo ha ido mal con el formulario")}}return r.a.createElement("div",null,r.a.createElement("h2",null,"Crear un nuevo juego es muy sencillo tan solo necesitas..."),r.a.createElement(w.a,{onSubmit:function(e){e.preventDefault(),l.createGame({creator:a._id,title:s,minLevel:p,description:v}).then((function(e){t(),console.log(e)})).catch((function(e){return console.log(e)})).finally((function(){return c.push("/")}))}},r.a.createElement(w.a.Group,{controlId:"title"},r.a.createElement(w.a.Label,null,"Elegir un titulo:"),r.a.createElement(w.a.Control,{name:"title",onChange:C,value:s,type:"text",placeholder:"El titulo de tu historia!"})),r.a.createElement(w.a.Group,{controlId:"minLevel"},r.a.createElement(w.a.Label,null,"Un nivel m\xednimo para comenzar la aventura:"),r.a.createElement("p",null,p),r.a.createElement(w.a.Control,{name:"minLevel",onChange:C,value:p,type:"range",min:"1",max:"20",step:"1",placeholder:"Ej: 5"}),r.a.createElement(w.a.Text,{className:"text-muted"},"Las aventuras b\xe1sicas comienzan en nivel 1, de 8 a 14 ya son todo un reto, a partir de ah\xed los heroes pueden luchar contra los mismos dioses.")),r.a.createElement(w.a.Group,{controlId:"description"},r.a.createElement(w.a.Label,null,"El resumen de tu aventura! Hazlo atractivo de forma que la gente quiera jugarla ;)"),r.a.createElement(w.a.Control,{name:"description",onChange:C,value:v,type:"text",placeholder:"El titulo de tu historia!"})),r.a.createElement(k.a,{type:"submit"},"Crear")))}));var T=function(e){var a=e.loggedInUser,t=e.updateLastGames;return r.a.createElement(U,{updateLastGames:t,loggedInUser:a})},F=t(61),_=t(26),N=t(230),R=function(){function e(){Object(b.a)(this,e),this.baseURL="".concat("https://tellmaster.herokuapp.com/api","/choices/"),this.service=O.a.create({baseURL:this.baseURL,withCredentials:!0})}return Object(C.a)(e,[{key:"getChoicesFromChapter",value:function(e){return this.service.get("/?chapterId=".concat(e)).then((function(e){return e.data.choicesFound})).catch((function(e){return console.log(e)}))}},{key:"createChoice",value:function(e){var a=e.description,t=e.trial,n=e.successTargetChapter,r=e.failureTargetChapter,c=e.pxGranted;return this.service.post("",{description:a,trial:t,successTargetChapter:n,failureTargetChapter:r,pxGranted:c}).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}},{key:"updateChoice",value:function(e){return this.service.patch("/",e).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}},{key:"deleteChoice",value:function(e){return this.service.delete("",{choiceId:e}).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}}]),e}(),A=function(){function e(){Object(b.a)(this,e),this.baseURL="".concat("https://tellmaster.herokuapp.com/api","/chapters/"),this.service=O.a.create({baseURL:this.baseURL,withCredentials:!0})}return Object(C.a)(e,[{key:"getChapter",value:function(e){return this.service.get("/?chapterId=".concat(e)).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}},{key:"getChaptersFromGame",value:function(e){return this.service.get("/fromGame/?gameId=".concat(e)).then((function(e){return e.data.chapters})).catch((function(e){return console.log(e)}))}},{key:"createChapter",value:function(e){var a=e.description,t=e.choices,n=e.gameId;return this.service.post("",{description:a,choices:t,gameId:n}).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}},{key:"updateChapter",value:function(e){return this.service.patch("/",e).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}}]),e}();var B=Object(l.f)((function(e){var a=e.finishChoiceForm,t=e.idx,c=e.choice,l=e.toogleCard,o=e.closeChoiceForm,i=e.match,s=new A,m=new R,d=Object(n.useState)(c?c.description:""),h=Object(u.a)(d,2),p=h[0],f=h[1],g=Object(n.useState)(c?c.trial.difficulty:10),E=Object(u.a)(g,2),v=E[0],b=E[1],C=Object(n.useState)(c?c.trial.characteristic:"str"),j=Object(u.a)(C,2),O=j[0],I=j[1],y=Object(n.useState)(c?c.pxGranted:0),S=Object(u.a)(y,2),L=S[0],G=S[1],x=Object(n.useState)(c?c.successTargetChapter:null),U=Object(u.a)(x,2),T=U[0],F=U[1],_=Object(n.useState)(c?c.failureTargetChapter:null),B=Object(u.a)(_,2),D=B[0],H=B[1],z=Object(n.useState)([]),M=Object(u.a)(z,2),P=M[0],K=M[1];function q(e){var a=e.currentTarget,t=a.name,n=a.value;switch(t){case"description":f(n);break;case"difficulty":b(n);break;case"characteristic":console.log(n),I(n);break;case"pxGranted":console.log(n),G(n);break;case"successTargetChapter":console.log(n),F(n);break;case"failureTargetChapter":console.log(n),H(n);break;default:throw Error("Algo ha ido mal con el formulario")}}return Object(n.useEffect)((function(){s.getChaptersFromGame(i.params.gameId).then((function(e){K(e)}))}),[i.params.gameId]),r.a.createElement(N.a,null,r.a.createElement(w.a,{onSubmit:function(e){e.preventDefault();var n={difficulty:v,characteristic:O};c?(c.trial=n,c.description=p,c.pxGranted=L,c.successTargetChapter=T,c.failureTargetChapter=D,function(e){m.updateChoice(e).then((function(e){l(t)}))}(c)):function(e){m.createChoice(e).then((function(e){a(e._id,t,e)}))}({description:p,trial:n,pxGranted:L,successTargetChapter:T,failureTargetChapter:D})},className:"choiceForm"},r.a.createElement(N.a.Header,{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement(k.a,{onClick:function(){o?o(t):l(t)},style:{width:"40px"},variant:"danger"},r.a.createElement("i",{className:"fas fa-times"})),r.a.createElement(k.a,{type:"submit",style:{width:"40px"},variant:"success"},r.a.createElement("i",{className:"fas fa-check"}))),r.a.createElement(N.a.Body,null,r.a.createElement(w.a.Group,{controlId:"choice"},r.a.createElement(w.a.Label,null,"Describe la elecci\xf3n:"),r.a.createElement(w.a.Control,{name:"description",onChange:q,value:p,placeholder:"Fuerzo la puerta"}),r.a.createElement(w.a.Label,null,"\xbfQue dificultad tiene?"),r.a.createElement(w.a.Control,{type:"number",name:"difficulty",onChange:q,value:v,placeholder:"Fuerzo la puerta"}),c?null:r.a.createElement(w.a.Text,null,"Dificultades de 10 son adecuadas para una persona media, 15 son para expertos y 20 para verdaderos prod\xedgios."),r.a.createElement(w.a.Label,null,"\xbfQu\xe9 caracteristica es necesaria para superarla?"),r.a.createElement(w.a.Control,{onChange:q,name:"characteristic",as:"select",custom:!0},r.a.createElement("option",{value:"str"},"Fuerza"),r.a.createElement("option",{value:"des"},"Destreza"),r.a.createElement("option",{value:"agi"},"Agilidad, velocidad"),r.a.createElement("option",{value:"con"},"Constituci\xf3n f\xedsica"),r.a.createElement("option",{value:"int"},"Inteligencia"),r.a.createElement("option",{value:"wis"},"Sabidur\xeda"),r.a.createElement("option",{value:"char"},"Carisma"))),r.a.createElement(w.a.Group,{controlId:"choice"},r.a.createElement(w.a.Label,null,"Cuanta experiencia da el \xe9xito:"),r.a.createElement(w.a.Control,{name:"pxGranted",onChange:q,value:L,placeholder:"100",type:"number"}))),r.a.createElement(w.a.Group,{controlId:"successTargetChapter"},r.a.createElement(w.a.Label,null,"Cap de destino con exito:"),r.a.createElement(w.a.Control,{as:"select",custom:!0,name:"successTargetChapter",onChange:q},r.a.createElement("option",{value:"null"},"Ninguno"),P.map((function(e){return e._id===T?r.a.createElement("option",{selected:!0,value:e._id},e.description):r.a.createElement("option",{value:e._id},e.description)})))),r.a.createElement(w.a.Group,{controlId:"failureTargetChapter"},r.a.createElement(w.a.Label,null,"Cap de destino con fracaso:"),r.a.createElement(w.a.Control,{as:"select",name:"failureTargetChapter",custom:!0,onChange:q},r.a.createElement("option",{value:"null"},"Ninguno"),P.map((function(e){return e._id===D?r.a.createElement("option",{selected:!0,value:e._id},e.description):r.a.createElement("option",{value:e._id},e.description)}))))))}));var D=function(e){var a=e.choice,t=e.idx,n=e.toogleCard;return r.a.createElement(N.a,null,r.a.createElement(N.a.Header,{onClick:function(){return n(t)}},"Editar"),r.a.createElement(N.a.Body,{style:{backgroundColor:a.successTargetChapter&&a.failureTargetChapter?"lightgreen":"orange"}},r.a.createElement("p",null,a.description),r.a.createElement("p",null,function(e){var a;switch(e){case"str":a="Fuerza";break;case"des":a="Destreza";break;case"agi":a="Agilidad, velocidad";break;case"con":a="Constituci\xf3n";break;case"wis":a="Sabidur\xeda";break;case"int":a="Inteligencia";break;case"char":a="Carisma";break;default:throw Error("algo fue mal con la card de la choice")}return a}(a.trial.characteristic)),r.a.createElement("p",null,a.trial.difficulty),r.a.createElement("p",null,a.pxGranted)))},H=t(112),z=t.n(H),M=t(113),P=t.n(M);var K=Object(l.f)((function(e){var a=e.updateLastGames,t=e.match,c=e.chapterId,l=e.getAllChapters,o=e.closeNewChapterForm,i=new A,s=t.params.gameId,m=Object(n.useState)(""),d=Object(u.a)(m,2),f=d[0],g=d[1],E=Object(n.useState)([]),v=Object(u.a)(E,2),b=v[0],C=v[1],j=Object(n.useState)([]),O=Object(u.a)(j,2),I=O[0],y=O[1],w=Object(n.useState)([]),S=Object(u.a)(w,2),L=S[0],G=S[1],x=Object(n.useState)(!1),U=Object(u.a)(x,2),T=U[0],N=U[1];function R(){c&&i.getChapter(c).then((function(e){g(e.description),y(e.choices),C(e.choices.filter((function(e){return e._id}))),N(!0)}))}function H(e,a,t){!function(e,a){var t=Object(_.a)(b);t.push(e),C(t)}(e),function(e){var a=Object(_.a)(I);a.push(e),y(a)}(t),M(a)}function M(e){var a=Object(_.a)(L);a.splice(e,1),G(a)}function K(e){console.log(e);var a=Object(_.a)(I),t=Object(F.a)({},a[e]);t.show=!I[e].show,a.splice(e,1,t),y(a)}return Object(n.useEffect)((function(){R()}),[]),c&&!T?"loading":r.a.createElement("div",{className:".ck-editor"},r.a.createElement(z.a,{editor:P.a,data:f||"El texto de tu capitulo va aqu\xed",onInit:function(e){console.log("Editor is ready to use!",e)},onChange:function(e,a){var t=a.getData();g(t),console.log({event:e,editor:a,data:t})},onBlur:function(e,a){console.log("Blur.",a)},onFocus:function(e,a){console.log("Focus.",a)}}),r.a.createElement(k.a,{onClick:function(e){var t;e.preventDefault(),c?(t={_id:c,description:f,choices:b},i.updateChapter(t).then((function(e){a(),R(),l()})).catch((function(e){return console.log(e)}))):(!function(e){i.createChapter(e).then((function(e){l(),a()})).catch((function(e){return console.log(e)}))}({description:f,choices:b,gameId:s}),o())}},c?"Modificar":"Crear"),r.a.createElement(k.a,{onClick:function(){var e=Object(_.a)(L);e.push(!0),G(e)}},"A\xf1adir elecci\xf3n"),r.a.createElement(h.a,null,I.map((function(e,a){return r.a.createElement(p.a,{key:a,lg:3},e.show?r.a.createElement(B,{toogleCard:K,choice:e,idx:a}):r.a.createElement(D,{toogleCard:K,choice:e,idx:a}))})),L.map((function(e,a){return r.a.createElement(p.a,{key:a,lg:3},r.a.cloneElement(r.a.createElement(B,null),{idx:a,finishChoiceForm:H,closeChoiceForm:M}))}))))})),q=t(231);var W=function(e){var a=e.loggedInUser,t=e.updateLastGames,c=e.match,l=e.history,o=new A,i=new I,s=Object(n.useState)([]),m=Object(u.a)(s,2),d=m[0],h=m[1],p=Object(n.useState)(!1),f=Object(u.a)(p,2),g=f[0],E=f[1];function v(){o.getChaptersFromGame(c.params.gameId).then((function(e){h(e)}))}return Object(n.useEffect)((function(){i.getOneGame(c.params.gameId).then((function(e){e.creator!==a._id&&l.replace("/read/".concat(c.params.gameId))}))}),[a]),Object(n.useEffect)((function(){v()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(q.a,null,d.map((function(e,n){return r.a.createElement(r.a.Fragment,null,r.a.createElement(q.a.Item,{active:e.show,onClick:function(){return function(e){var a=Object(_.a)(d),t=Object(F.a)({},a[e]);t.show=!d[e].show,a.splice(e,1,t),h(a)}(n)}},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:e.description}})),e.show?r.a.createElement(q.a.Item,null,r.a.createElement(K,{chapterId:e._id,getAllChapters:v,loggedInUser:a,updateLastGames:t})):null)})),r.a.createElement(q.a.Item,{onClick:function(){return E(!g)}},"O escribe un nuevo capitulo"),g?r.a.createElement(K,{closeNewChapterForm:function(){return E(!1)},getAllChapters:v,loggedInUser:a,updateLastGames:t}):null))},J=function(){function e(){Object(b.a)(this,e),this.baseURL="".concat("https://tellmaster.herokuapp.com/api","/savedGames/"),this.service=O.a.create({baseURL:this.baseURL,withCredentials:!0})}return Object(C.a)(e,[{key:"getUserSaves",value:function(e,a){var t=a?"/user/?userId=".concat(e,"&gameId=").concat(a):"/user/?userId=".concat(e);return this.service.get(t).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}},{key:"getFullSave",value:function(e){return this.service.get("/full/?saveId=".concat(e)).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}},{key:"createSavedGame",value:function(e){var a=e.gameId,t=e.currentChapter,n=e.character;return this.service.post("",{gameId:a,currentChapter:t,character:n}).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}},{key:"assignSaveToUser",value:function(e,a){return this.service.post("/assign",{userId:e,saveId:a}).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}},{key:"updateSavedGame",value:function(e){var a=e.savedGameId,t=e.gameId,n=e.currentChapter,r=e.character;return this.service.patch("",{savedGameId:a,gameId:t,currentChapter:n,character:r}).then((function(e){return e.data}))}},{key:"deleteSave",value:function(e){return this.service.delete("",{savedGameId:e}).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}}]),e}(),Q=function(){function e(){Object(b.a)(this,e),this.baseURL="".concat("https://tellmaster.herokuapp.com/api","/characters/"),this.service=O.a.create({baseURL:this.baseURL,withCredentials:!0})}return Object(C.a)(e,[{key:"getCharactersFromUser",value:function(e){return this.service.get("/?userId=".concat(e)).then((function(e){return e.data.characters})).catch((function(e){return console.log(e)}))}},{key:"createCharacter",value:function(e){return this.service.post("",{character:e}).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}},{key:"assignCharacterToUser",value:function(e,a){return this.service.post("assign",{userId:e,characterId:a}).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}}]),e}();var $=function(e){e.setCharacter;var a=e.hideForm,t=e.setUser,c=e.loggedInUser,l=new Q,o=Object(n.useState)(""),i=Object(u.a)(o,2),s=i[0],m=i[1],d=Object(n.useState)(100),h=Object(u.a)(d,1)[0],p=Object(n.useState)(8),f=Object(u.a)(p,2),g=f[0],E=f[1],v=Object(n.useState)(8),b=Object(u.a)(v,2),C=b[0],j=b[1],O=Object(n.useState)(8),I=Object(u.a)(O,2),y=I[0],S=I[1],L=Object(n.useState)(8),G=Object(u.a)(L,2),x=G[0],U=G[1],T=Object(n.useState)(8),F=Object(u.a)(T,2),_=F[0],N=F[1],R=Object(n.useState)(8),A=Object(u.a)(R,2),B=A[0],D=A[1],H=Object(n.useState)(8),z=Object(u.a)(H,2),M=z[0],P=z[1],K=Object(n.useState)(27),q=Object(u.a)(K,2),W=q[0],J=q[1];function $(e){var a=e.currentTarget,t=a.name,n=a.value,r=W;if(console.log(n),"name"!==t&&(r=function(e,a){var t=27,n={str:g,des:C,agi:y,con:x,int:_,wis:B,char:M};for(var r in n[e]=a,n)t-=n[r]-8;return t}(t,n)),console.log(r),r>=0){switch(t){case"name":m(n);break;case"str":E(n);break;case"des":j(n);break;case"agi":S(n);break;case"con":U(n);break;case"int":N(n);break;case"wis":D(n);break;case"char":P(n);break;default:throw Error("Algo fue mal con el formulario")}J(r)}}return r.a.createElement(w.a,{onSubmit:function(e){e.preventDefault();var n={name:s,hp:h,str:g,des:C,agi:y,con:x,int:_,wis:B,char:M};l.createCharacter(n).then((function(e){l.assignCharacterToUser(c._id,e._id).then((function(e){t(e)})),m(""),a()}))}},r.a.createElement(w.a.Group,{controlId:"name"},r.a.createElement(w.a.Label,null,"Nombre del personaje"),r.a.createElement(w.a.Control,{onChange:$,value:s,name:"name",type:"text",placeholder:"Aragor, hijo de Arathorn"})),!W&&r.a.createElement("p",null,r.a.createElement("em",null,"Has superado el m\xe1ximo de puntos a repartir")),r.a.createElement(w.a.Group,{controlId:"str"},r.a.createElement(w.a.Label,null,"Fuerza"),r.a.createElement(w.a.Control,{onChange:$,value:g,name:"str",type:"number",min:7,max:18}),r.a.createElement(w.a.Text,null,"Bonificaci\xf3n al dado: ",parseInt(g/2-5))),r.a.createElement(w.a.Group,{controlId:"des"},r.a.createElement(w.a.Label,null,"Destreza"),r.a.createElement(w.a.Control,{onChange:$,value:C,name:"des",type:"number",min:7,max:18}),r.a.createElement(w.a.Text,null,"Bonificaci\xf3n al dado: ",parseInt(C/2-5))),r.a.createElement(w.a.Group,{controlId:"agi"},r.a.createElement(w.a.Label,null,"Agilidad, velocidad"),r.a.createElement(w.a.Control,{onChange:$,value:y,name:"agi",type:"number",min:7,max:18}),r.a.createElement(w.a.Text,null,"Bonificaci\xf3n al dado: ",parseInt(y/2-5))),r.a.createElement(w.a.Group,{controlId:"con"},r.a.createElement(w.a.Label,null,"Constituci\xf3n f\xedsica, fortaleza"),r.a.createElement(w.a.Control,{onChange:$,value:x,name:"con",type:"number",min:7,max:18}),r.a.createElement(w.a.Text,null,"Bonificaci\xf3n al dado: ",parseInt(x/2-5))),r.a.createElement(w.a.Group,{controlId:"int"},r.a.createElement(w.a.Label,null,"Inteligencia"),r.a.createElement(w.a.Control,{onChange:$,value:_,name:"int",type:"number",min:7,max:18}),r.a.createElement(w.a.Text,null,"Bonificaci\xf3n al dado: ",parseInt(_/2-5))),r.a.createElement(w.a.Group,{controlId:"wis"},r.a.createElement(w.a.Label,null,"Sabidur\xeda, astucia"),r.a.createElement(w.a.Control,{onChange:$,value:B,name:"wis",type:"number",min:7,max:18}),r.a.createElement(w.a.Text,null,"Bonificaci\xf3n al dado: ",parseInt(B/2-5))),r.a.createElement(w.a.Group,{controlId:"char"},r.a.createElement(w.a.Label,null,"Carisma"),r.a.createElement(w.a.Control,{onChange:$,value:M,name:"char",type:"number",min:7,max:18}),r.a.createElement(w.a.Text,null,"Bonificaci\xf3n al dado: ",parseInt(M/2-5))),r.a.createElement(k.a,{variant:"primary",type:"submit"},"Crear"))};var V=function(e){var a=e.characters,t=e.newSave;return console.log(t),r.a.createElement("ul",null,a.map((function(e){return r.a.createElement("li",null,r.a.createElement("p",null,r.a.createElement("button",{onClick:t?function(){return t(e._id)}:null},e.name,". Nivel: ",e.level," ")),r.a.createElement("small",null,"Fue: ",e.str," Des: ",e.des," Agi: ",e.agi," Int: ",e.int," Sab: ",e.wis," Car: ",e.char))})))};var X=Object(l.f)((function(e){var a=e.loggedInUser,t=e.setUser,c=e.match,l=e.updateSavedGames,o=e.history,i=new A,s=new J,m=Object(n.useState)(null),d=Object(u.a)(m,2)[1],h=Object(n.useState)(!1),p=Object(u.a)(h,2),f=p[0],g=p[1];function E(){g(!f)}return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Elige un personaje para jugar: "),a.characters.length>0&&r.a.createElement(V,{newSave:function(e){i.getChaptersFromGame(c.params.gameId).then((function(a){return s.createSavedGame({gameId:c.params.gameId,currentChapter:a[0]._id,character:e})})).then((function(e){return l(e),o.push("/chapter/".concat(e._id)),s.assignSaveToUser(a._id,e._id)})).then((function(e){t(e)}))},characters:a.characters}),r.a.createElement("button",{onClick:E},"Tambi\xe9n puedes crear un nuevo personaje"),f&&r.a.createElement($,{hideForm:E,setUser:t,loggedInUser:a,setCharacter:d}))})),Y=r.a.createContext(!1),Z=Y.Provider,ee=Y,ae=t(31);var te=Object(l.f)((function(e){var a=e.game,t=e.savedGames;console.log(e);var l=Object(n.useContext)(ee);return e.noUser?a?r.a.createElement("section",null,r.a.createElement("article",null,r.a.createElement("h1",null,a.title),r.a.createElement("p",null,a.description),r.a.createElement(ae.a,null,r.a.createElement(ae.a.Toggle,{variant:"failure",id:"dropdown-basic"},"Para jugar, registrate."),r.a.createElement(ae.a.Menu,null)))):r.a.createElement("p",null,"Loading game"):a?r.a.createElement("section",null,r.a.createElement("article",null,r.a.createElement("h1",null,a.title),r.a.createElement("p",null,a.description),l?r.a.createElement(r.a.Fragment,null,r.a.createElement(ae.a,null,r.a.createElement(ae.a.Toggle,{variant:"success",id:"dropdown-basic"},"Continua la aventura"),r.a.createElement(ae.a.Menu,null,t.map((function(e){return r.a.createElement(c.b,{to:"/chapter/".concat(e._id)},r.a.createElement(ae.a.Item,{disabled:!0},e.character.name))}))))):r.a.createElement("button",{disabled:!0},"Continuar la aventura"))):r.a.createElement("p",null,"loading game")}));var ne=Object(l.f)((function(e){var a=new I,t=new J,c=e.match,l=e.loggedInUser,o=e.setUser,i=c.params.gameId,s=Object(n.useState)(null),m=Object(u.a)(s,2),d=m[0],f=m[1],g=Object(n.useState)([]),E=Object(u.a)(g,2),v=E[0],b=E[1];return Object(n.useEffect)((function(){a.getOneGame(e.match.params.gameId).then((function(e){return f(e)})),l&&t.getUserSaves(l._id,i).then((function(e){return b(e)}))}),[e.match.params.gameId,l._id]),e.noUser?r.a.createElement(te,{game:d,noUser:e.noUser}):r.a.createElement(h.a,{style:{justifyContent:"space-between"}},r.a.createElement(p.a,{lg:5},r.a.createElement(X,{updateSavedGames:function(e){var a=Object(_.a)(v);a.push(e),b(a)},setUser:o,loggedInUser:l})),r.a.createElement(p.a,{lg:5},r.a.createElement(te,{game:d,savedGames:v})))})),re=function(){function e(){Object(b.a)(this,e),this.baseURL="".concat("https://tellmaster.herokuapp.com/api","/characterChoices/"),this.service=O.a.create({baseURL:this.baseURL,withCredentials:!0})}return Object(C.a)(e,[{key:"makeChoice",value:function(e,a,t){return this.service.post("/makeChoice",{saveId:e,choiceId:a,characterId:t}).then((function(e){return e.data})).catch((function(e){return console.log(e)}))}}]),e}();var ce=Object(l.f)((function(e){var a=new re,t=e.game,n=t.currentChapter,c=t.character;function l(t){a.makeChoice(e.game._id,t.currentTarget.id,c._id).then((function(a){console.log(a),e.updateChapter()}))}return r.a.createElement("div",null,r.a.createElement("div",{dangerouslySetInnerHTML:{__html:n.description}}),n.choices.map((function(e){return e.successTargetChapter&&e.failureTargetChapter?r.a.createElement("button",{onClick:l,id:e._id},e.description):r.a.createElement("button",{disabled:!0,onClick:l,id:e._id},e.description)})))}));var le=Object(l.f)((function(e){var a=new J,t=e.match,c=Object(n.useState)(null),l=Object(u.a)(c,2),o=l[0],i=l[1],s=Object(n.useState)(!1),d=Object(u.a)(s,2),h=d[0],p=d[1];return Object(n.useEffect)((function(){a.getFullSave(t.params.savedGameId).then((function(e){console.log(e,t.params.savedGameId),i(e),p(!0)}))}),[t.params.savedGameId]),h?r.a.createElement(ce,{updateChapter:function(){a.getFullSave(t.params.savedGameId).then((function(e){console.log(e,t.params.savedGameId),i(e),p(!0)}))},game:o}):r.a.createElement(m.a,null)}));t(27);var oe=function(){var e=new I,a=new y,t=Object(n.useState)([]),c=Object(u.a)(t,2),o=c[0],i=c[1],m=Object(n.useState)(!1),d=Object(u.a)(m,2),h=d[0],p=d[1];function f(e){p(e)}function b(){e.getLastGames().then((function(e){Array.isArray(e)&&!e.every((function(e){return o.find((function(a){return a._id===e._id}))}))&&i(e)}))}Object(n.useEffect)((function(){return b(),function(){i([])}}),[]),Object(n.useEffect)((function(){return!1===h&&a.loggedin().then((function(e){p(e||null)})),function(){}}),[]);var C=Object(n.useState)(!1),j=Object(u.a)(C,2),O=j[0],w=j[1],k=Object(n.useState)(!1),G=Object(u.a)(k,2),U=G[0],F=G[1];return r.a.createElement(l.c,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(Z,{value:h},r.a.createElement(g,{logout:function(){a.logout().then((function(){return p(null)}))},showSignup:function(){return F(!0)},showLogin:function(){return w(!0)},loggedInUser:h}),r.a.createElement(s.a,{fluid:!0},r.a.createElement("main",{className:"app-wrapper"},r.a.createElement(l.a,{exact:!0,path:"/",render:function(){return r.a.createElement(E,{loggedInUser:h,games:o})}}),h?r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,{exact:!0,path:"/myGames",render:function(){return r.a.createElement(v,{loggedInUser:h})}}),r.a.createElement(l.a,{exact:!0,path:"/newGame",render:function(){return r.a.createElement(T,{updateLastGames:b,loggedInUser:h})}}),r.a.createElement(l.a,{exact:!0,path:"/myCharacters",render:function(){return r.a.createElement(V,{characters:h.characters})}}),r.a.createElement(l.a,{exact:!0,path:"/modify/:gameId",render:function(e){var a=e.match,t=e.history;return r.a.createElement(W,{history:t,match:a,updateLastGames:b,loggedInUser:h})}}),r.a.createElement(l.a,{exact:!0,path:"/chapter/:savedGameId",render:function(){return r.a.createElement(le,null)}}),r.a.createElement(l.a,{exact:!0,path:"/read/:gameId",render:function(){return r.a.createElement(ne,{setUser:f,loggedInUser:h})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,{exact:!0,path:"/read/:gameId",render:function(){return r.a.createElement(ne,{noUser:!0,setUser:f,loggedInUser:h})}}),r.a.createElement(l.a,{exact:!0,path:"/:algo"},r.a.createElement("h1",null,"Para ver este contenido has de estar logueado")),r.a.createElement(x,{title:"Login",show:O,onHide:function(){return w(!1)}},r.a.createElement(S,{setUser:f})),r.a.createElement(x,{title:"Signup",show:U,onHide:function(){return F(!1)}},r.a.createElement(L,{setUser:f}))))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(c.a,null,r.a.createElement(l.a,{path:"/",render:function(e){return r.a.createElement(oe,e)}}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[120,1,2]]]);
//# sourceMappingURL=main.6c9dfdc0.chunk.js.map